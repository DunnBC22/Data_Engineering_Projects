{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v5.json", "dbt_version": "1.7.4", "generated_at": "2024-02-02T18:17:08.471799Z", "invocation_id": "95e540f1-5122-4d84-beff-30f22df9f0ac", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-02-02T18:17:08.332671Z", "completed_at": "2024-02-02T18:17:08.342911Z"}, {"name": "execute", "started_at": "2024-02-02T18:17:08.343803Z", "completed_at": "2024-02-02T18:17:08.343814Z"}], "thread_id": "Thread-1", "execution_time": 0.012923240661621094, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.iowa_liquor_sales.iowa_liquor_sales_dbt_model", "compiled": true, "compiled_code": "/*\n    Title: Iowa Liquor Sales Pipeline\n\n    Author: Brian Dunn\n\n    Date: 01/26/2024\n\n    Summary: Retrieve table and prepare it for analysis.\n\n    Data Source: https://www.kaggle.com/datasets/prattayds/iowa-liquor-sales-full-dataset\n*/\n\n\n\nwith source_data as (\n    SELECT \n        ROW_NUMBER() OVER () as id,\n        invoice_item_number,\n        date_of_sale,\n        CAST(COALESCE(EXTRACT(YEAR FROM date_of_sale), -1) AS INTEGER) AS sales_year,\n        CAST(COALESCE(EXTRACT(MONTH FROM date_of_sale), -1) AS INTEGER) AS sales_month,\n        CAST(COALESCE(EXTRACT(DAY FROM date_of_sale), -1) AS INTEGER) AS sales_day,\n        store_number,\n        TRIM(BOTH ' ' FROM store_name) AS store_name,\n        TRIM(BOTH ' ' FROM store_address) AS store_address,\n        TRIM(BOTH ' ' FROM store_city) AS store_city,\n        CASE\n            WHEN store_number = '4307' THEN '51529'\n            ELSE COALESCE(REGEXP_REPLACE(store_zip_code, '[,\"]', '', 'g'), '00000')\n        END AS store_zip_code,\n        store_location,\n        store_county_number,\n        TRIM(BOTH ' ' FROM store_county) AS store_county,\n        TRIM(BOTH ' ' FROM item_category) AS item_category,\n        TRIM(BOTH ' ' FROM category_name) AS category_name,\n        vendor_number,\n        TRIM(BOTH ' ' FROM vendor_name) AS vendor_name,\n        item_number,\n        item_description,\n        COALESCE(pack, -1) AS pack,\n        CAST(COALESCE(REGEXP_REPLACE(bottle_volume, '[,\"]', '', 'g'), '-1') AS INTEGER) AS bottle_volume,\n        CAST(COALESCE(REGEXP_REPLACE(state_bottle_cost, '[,\"]', '', 'g'), '-1') AS FLOAT) AS state_bottle_cost,\n        CAST(COALESCE(REGEXP_REPLACE(state_bottle_retail, '[,\"]', '', 'g'), '-1') AS FLOAT) AS state_bottle_retail,\n        CAST(COALESCE(REGEXP_REPLACE(bottles_sold, '[,\"]', '', 'g'), '-1') AS INTEGER) AS bottles_sold,\n        CAST(COALESCE(REGEXP_REPLACE(sale_dollars, '[,\"]', '', 'g'), '-1') AS FLOAT) AS sales_dollars,\n        CAST(COALESCE(REGEXP_REPLACE(volume_sold_liters, '[,\"]', '', 'g'), '-1') AS FLOAT) AS volume_sold_liters,\n        CAST(COALESCE(REGEXP_REPLACE(volume_sold_gallons, '[,\"]', '', 'g'), '-1') AS FLOAT) AS volume_sold_gallons,\n        CAST(COALESCE(REGEXP_REPLACE(iowa_zip_code_tabulation_areas, '[,\"]', '', 'g'), '-1') AS FLOAT) AS iowa_zipcode_tab_areas,\n        CAST(COALESCE(REGEXP_REPLACE(iowa_watershed_sub_basins, '[,\"]', '', 'g'), '-1') AS FLOAT) AS iowa_watershed_sub_basins,\n        CAST(COALESCE(REGEXP_REPLACE(iowa_watersheds, '[,\"]', '', 'g'), '-1') AS FLOAT) AS iowa_watersheds,\n        CAST(COALESCE(county_boundaries_of_iowa, '-1') AS FLOAT) AS iowa_county_boundaries,\n        CAST(COALESCE(REGEXP_REPLACE(us_counties, '[,\"]', '', 'g'), '-1') AS INTEGER) AS us_counties\n    FROM iowa_liquor_sales\n)\nselect\n    id,\n    store_number,\n    store_name,\n    store_city,\n    store_zip_code,\n    store_county,\n    item_category,\n    category_name,\n    vendor_name,\n    pack,\n    bottle_volume,\n    state_bottle_cost,\n    state_bottle_retail,\n    bottles_sold,\n    sales_dollars,\n    volume_sold_gallons,\n    iowa_zipcode_tab_areas,\n    iowa_watershed_sub_basins,\n    iowa_watersheds,\n    iowa_county_boundaries,\n    us_counties,\n    sales_year,\n    sales_month,\n    sales_day\nfrom source_data", "relation_name": "\"dbt_ils\".\"public\".\"iowa_liquor_sales_dbt_model\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-02-02T18:17:08.347019Z", "completed_at": "2024-02-02T18:17:08.351556Z"}, {"name": "execute", "started_at": "2024-02-02T18:17:08.352372Z", "completed_at": "2024-02-02T18:17:08.352379Z"}], "thread_id": "Thread-1", "execution_time": 0.007047176361083984, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.iowa_liquor_sales.iowa_liquor_sales_dbt_model_2", "compiled": true, "compiled_code": "/*\n    Title: Iowa Liquor Sales Pipeline\n\n    Author: Brian Dunn\n\n    Date: 01/26/2024\n\n    Summary: Retrieve table and prepare it for analysis.\n\n    Data Source: https://www.kaggle.com/datasets/prattayds/iowa-liquor-sales-full-dataset\n*/\n\n\n\nwith cleaned_data as (\n    select\n        *\n    from \"dbt_ils\".\"public\".\"iowa_liquor_sales_dbt_model\"\n    where\n        (\n            \n                store_number is not null\n                 and \n            \n                store_name is not null\n                 and \n            \n                store_city is not null\n                 and \n            \n                store_zip_code is not null\n                 and \n            \n                store_county is not null\n                 and \n            \n                item_category is not null\n                 and \n            \n                category_name is not null\n                 and \n            \n                vendor_name is not null\n                 and \n            \n                state_bottle_cost is not null\n                 and \n            \n                state_bottle_retail is not null\n                 and \n            \n                sales_dollars is not null\n                 and \n            \n                iowa_zipcode_tab_areas is not null\n                 and \n            \n                iowa_watershed_sub_basins is not null\n                 and \n            \n                iowa_watersheds is not null\n                 and \n            \n                iowa_county_boundaries is not null\n                 and \n            \n                us_counties is not null\n                \n            \n        )\n)\n\nselect * from cleaned_data", "relation_name": "\"dbt_ils\".\"public\".\"iowa_liquor_sales_dbt_model_2\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-02-02T18:17:08.354992Z", "completed_at": "2024-02-02T18:17:08.366654Z"}, {"name": "execute", "started_at": "2024-02-02T18:17:08.367586Z", "completed_at": "2024-02-02T18:17:08.367594Z"}], "thread_id": "Thread-1", "execution_time": 0.01419687271118164, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.iowa_liquor_sales.not_null_iowa_liquor_sales_dbt_model_bottle_volume.d79a74fa6c", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect bottle_volume\nfrom \"dbt_ils\".\"public\".\"iowa_liquor_sales_dbt_model\"\nwhere bottle_volume is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-02-02T18:17:08.370139Z", "completed_at": "2024-02-02T18:17:08.375075Z"}, {"name": "execute", "started_at": "2024-02-02T18:17:08.375983Z", "completed_at": "2024-02-02T18:17:08.375990Z"}], "thread_id": "Thread-1", "execution_time": 0.0074748992919921875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.iowa_liquor_sales.not_null_iowa_liquor_sales_dbt_model_bottles_sold.f46edba25e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect bottles_sold\nfrom \"dbt_ils\".\"public\".\"iowa_liquor_sales_dbt_model\"\nwhere bottles_sold is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-02-02T18:17:08.378777Z", "completed_at": "2024-02-02T18:17:08.384075Z"}, {"name": "execute", "started_at": "2024-02-02T18:17:08.384958Z", "completed_at": "2024-02-02T18:17:08.384967Z"}], "thread_id": "Thread-1", "execution_time": 0.007957935333251953, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.iowa_liquor_sales.not_null_iowa_liquor_sales_dbt_model_pack.6a2746297e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect pack\nfrom \"dbt_ils\".\"public\".\"iowa_liquor_sales_dbt_model\"\nwhere pack is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-02-02T18:17:08.387464Z", "completed_at": "2024-02-02T18:17:08.392733Z"}, {"name": "execute", "started_at": "2024-02-02T18:17:08.393480Z", "completed_at": "2024-02-02T18:17:08.393486Z"}], "thread_id": "Thread-1", "execution_time": 0.007565021514892578, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.iowa_liquor_sales.not_null_iowa_liquor_sales_dbt_model_sales_day.542bb15a72", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect sales_day\nfrom \"dbt_ils\".\"public\".\"iowa_liquor_sales_dbt_model\"\nwhere sales_day is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-02-02T18:17:08.395765Z", "completed_at": "2024-02-02T18:17:08.400188Z"}, {"name": "execute", "started_at": "2024-02-02T18:17:08.401080Z", "completed_at": "2024-02-02T18:17:08.401086Z"}], "thread_id": "Thread-1", "execution_time": 0.006875276565551758, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.iowa_liquor_sales.not_null_iowa_liquor_sales_dbt_model_sales_dollars.9c26a2b781", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect sales_dollars\nfrom \"dbt_ils\".\"public\".\"iowa_liquor_sales_dbt_model\"\nwhere sales_dollars is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-02-02T18:17:08.403590Z", "completed_at": "2024-02-02T18:17:08.407940Z"}, {"name": "execute", "started_at": "2024-02-02T18:17:08.408744Z", "completed_at": "2024-02-02T18:17:08.408749Z"}], "thread_id": "Thread-1", "execution_time": 0.006692171096801758, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.iowa_liquor_sales.not_null_iowa_liquor_sales_dbt_model_sales_month.8cd69f4e75", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect sales_month\nfrom \"dbt_ils\".\"public\".\"iowa_liquor_sales_dbt_model\"\nwhere sales_month is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-02-02T18:17:08.411138Z", "completed_at": "2024-02-02T18:17:08.415154Z"}, {"name": "execute", "started_at": "2024-02-02T18:17:08.415937Z", "completed_at": "2024-02-02T18:17:08.415943Z"}], "thread_id": "Thread-1", "execution_time": 0.006310939788818359, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.iowa_liquor_sales.not_null_iowa_liquor_sales_dbt_model_sales_year.2c186ea066", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect sales_year\nfrom \"dbt_ils\".\"public\".\"iowa_liquor_sales_dbt_model\"\nwhere sales_year is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-02-02T18:17:08.418369Z", "completed_at": "2024-02-02T18:17:08.422400Z"}, {"name": "execute", "started_at": "2024-02-02T18:17:08.423125Z", "completed_at": "2024-02-02T18:17:08.423131Z"}], "thread_id": "Thread-1", "execution_time": 0.00630497932434082, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.iowa_liquor_sales.not_null_iowa_liquor_sales_dbt_model_store_name.de2d8f2fb7", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect store_name\nfrom \"dbt_ils\".\"public\".\"iowa_liquor_sales_dbt_model\"\nwhere store_name is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-02-02T18:17:08.425447Z", "completed_at": "2024-02-02T18:17:08.430394Z"}, {"name": "execute", "started_at": "2024-02-02T18:17:08.431157Z", "completed_at": "2024-02-02T18:17:08.431163Z"}], "thread_id": "Thread-1", "execution_time": 0.0071659088134765625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.iowa_liquor_sales.not_null_iowa_liquor_sales_dbt_model_store_number.ce8c61e73e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect store_number\nfrom \"dbt_ils\".\"public\".\"iowa_liquor_sales_dbt_model\"\nwhere store_number is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-02-02T18:17:08.433536Z", "completed_at": "2024-02-02T18:17:08.437488Z"}, {"name": "execute", "started_at": "2024-02-02T18:17:08.438232Z", "completed_at": "2024-02-02T18:17:08.438238Z"}], "thread_id": "Thread-1", "execution_time": 0.006225109100341797, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.iowa_liquor_sales.not_null_iowa_liquor_sales_dbt_model_volume_sold_gallons.addbc43764", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect volume_sold_gallons\nfrom \"dbt_ils\".\"public\".\"iowa_liquor_sales_dbt_model\"\nwhere volume_sold_gallons is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-02-02T18:17:08.440573Z", "completed_at": "2024-02-02T18:17:08.444118Z"}, {"name": "execute", "started_at": "2024-02-02T18:17:08.444875Z", "completed_at": "2024-02-02T18:17:08.444880Z"}], "thread_id": "Thread-1", "execution_time": 0.00578618049621582, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.iowa_liquor_sales.iowa_liquor_sales_dbt_model_3", "compiled": true, "compiled_code": "/*\n    Title: Iowa Liquor Sales Pipeline\n\n    Author: Brian Dunn\n\n    Date: 01/26/2024\n\n    Summary: Retrieve table and prepare it for analysis.\n\n    Data Source: https://www.kaggle.com/datasets/prattayds/iowa-liquor-sales-full-dataset\n*/\n\n\n\nWITH filtered_data AS (\n    SELECT *\n    FROM \"dbt_ils\".\"public\".\"iowa_liquor_sales_dbt_model_2\"\n    WHERE sales_dollars < 10001\n)\n\nSELECT *\nFROM filtered_data", "relation_name": "\"dbt_ils\".\"public\".\"iowa_liquor_sales_dbt_model_3\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-02-02T18:17:08.447564Z", "completed_at": "2024-02-02T18:17:08.450546Z"}, {"name": "execute", "started_at": "2024-02-02T18:17:08.451287Z", "completed_at": "2024-02-02T18:17:08.451293Z"}], "thread_id": "Thread-1", "execution_time": 0.005193948745727539, "adapter_response": {}, "message": null, "failures": null, "unique_id": "analysis.iowa_liquor_sales.iowa_liquor_sales_1", "compiled": true, "compiled_code": "WITH iowa_liquor_data as (\n    SELECT \n        id,\n        store_number,\n        store_name,\n        store_city,\n        store_zip_code,\n        store_county,\n        item_category,\n        category_name,\n        vendor_name,\n        bottles_sold,\n        sales_dollars,\n        us_counties,\n        sales_year,\n        sales_month,\n        sales_day\n    FROM \"dbt_ils\".\"public\".\"iowa_liquor_sales_dbt_model_3\"\n)\n\nSELECT\n    SUM(sales_dollars) OVER (PARTITION BY sales_month ORDER BY id ROWS UNBOUNDED PRECEDING)\nFROM iowa_liquor_data\nORDER BY sales_month", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-02-02T18:17:08.453548Z", "completed_at": "2024-02-02T18:17:08.456294Z"}, {"name": "execute", "started_at": "2024-02-02T18:17:08.457035Z", "completed_at": "2024-02-02T18:17:08.457041Z"}], "thread_id": "Thread-1", "execution_time": 0.004918098449707031, "adapter_response": {}, "message": null, "failures": null, "unique_id": "analysis.iowa_liquor_sales.iowa_liquor_sales_2", "compiled": true, "compiled_code": "WITH iowa_liquor_data as (\n    SELECT \n        id,\n        store_number,\n        store_name,\n        store_city,\n        store_zip_code,\n        store_county,\n        item_category,\n        category_name,\n        vendor_name,\n        bottles_sold,\n        sales_dollars,\n        us_counties,\n        sales_year,\n        sales_month,\n        sales_day\n    FROM \"dbt_ils\".\"public\".\"iowa_liquor_sales_dbt_model_3\"\n)\n\nSELECT\n    SUM(sales_dollars) OVER (PARTITION BY sales_year ORDER BY id ROWS UNBOUNDED PRECEDING)\nFROM iowa_liquor_data\nORDER BY sales_year", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-02-02T18:17:08.459339Z", "completed_at": "2024-02-02T18:17:08.462131Z"}, {"name": "execute", "started_at": "2024-02-02T18:17:08.462857Z", "completed_at": "2024-02-02T18:17:08.462863Z"}], "thread_id": "Thread-1", "execution_time": 0.004976987838745117, "adapter_response": {}, "message": null, "failures": null, "unique_id": "analysis.iowa_liquor_sales.iowa_liquor_sales_3", "compiled": true, "compiled_code": "WITH iowa_liquor_data as (\n    SELECT \n        id,\n        store_number,\n        store_name,\n        store_city,\n        store_county,\n        item_category,\n        category_name,\n        vendor_name,\n        bottles_sold,\n        sales_dollars,\n        us_counties,\n        sales_year,\n        sales_month,\n        sales_day\n    FROM \"dbt_ils\".\"public\".\"iowa_liquor_sales_dbt_model_3\"\n)\n\nSELECT\n    SUM(sales_dollars) OVER (PARTITION BY store_county ORDER BY id ROWS UNBOUNDED PRECEDING)\nFROM iowa_liquor_data\nORDER BY store_county", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-02-02T18:17:08.466225Z", "completed_at": "2024-02-02T18:17:08.468924Z"}, {"name": "execute", "started_at": "2024-02-02T18:17:08.469705Z", "completed_at": "2024-02-02T18:17:08.469711Z"}], "thread_id": "Thread-1", "execution_time": 0.005995988845825195, "adapter_response": {}, "message": null, "failures": null, "unique_id": "snapshot.iowa_liquor_sales.iowa_liquor_sales_snapshot", "compiled": true, "compiled_code": "\n\n\n\nselect * from \"dbt_ils\".\"public\".\"iowa_liquor_sales_dbt_model_3\"\n", "relation_name": "\"dbt_ils\".\"snapshots\".\"iowa_liquor_sales_snapshot\""}], "elapsed_time": 0.2346329689025879, "args": {"favor_state": false, "log_format_file": "debug", "which": "compile", "log_level": "info", "log_level_file": "debug", "invocation_command": "dbt compile", "macro_debugging": false, "static_parser": true, "use_colors": true, "write_json": true, "print": true, "partial_parse_file_diff": true, "warn_error_options": {"include": [], "exclude": []}, "profiles_dir": "/Users/briandunn/.dbt", "indirect_selection": "eager", "vars": {}, "log_format": "default", "cache_selected_only": false, "send_anonymous_usage_stats": true, "output": "text", "strict_mode": false, "defer": false, "log_path": "/Users/briandunn/Desktop/dbt Projects/iowa_liquor_sales/logs", "select": [], "partial_parse": true, "printer_width": 80, "quiet": false, "version_check": true, "project_dir": "/Users/briandunn/Desktop/dbt Projects/iowa_liquor_sales", "exclude": [], "show_resource_report": false, "use_colors_file": true, "log_file_max_bytes": 10485760, "introspect": true, "enable_legacy_logger": false, "populate_cache": true, "inject_ephemeral_ctes": true}}